{
  "openapi": "3.0.0",
  "paths": {
    "/": {
      "get": {
        "operationId": "AppController_welcome",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Health"
        ]
      }
    },
    "/users/me": {
      "get": {
        "operationId": "UsersController_getMe",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "accessToken": []
          }
        ],
        "tags": [
          "Users"
        ]
      },
      "patch": {
        "operationId": "UsersController_updateMe",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateProfileDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "accessToken": []
          }
        ],
        "summary": "Update current user profile",
        "tags": [
          "Users"
        ]
      }
    },
    "/users/me/password": {
      "patch": {
        "operationId": "UsersController_changePassword",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ChangePasswordDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "accessToken": []
          }
        ],
        "summary": "Change current user password",
        "tags": [
          "Users"
        ]
      }
    },
    "/users/{id}": {
      "get": {
        "operationId": "UsersController_getUsers",
        "parameters": [
          {
            "name": "id",
            "required": false,
            "in": "path",
            "description": "get user with a specific id",
            "schema": {
              "example": 1234,
              "type": "number"
            }
          },
          {
            "name": "limit",
            "required": false,
            "in": "query",
            "description": "The nymber of entries returned par page",
            "schema": {
              "example": "10",
              "type": "number"
            }
          },
          {
            "name": "page",
            "required": false,
            "in": "query",
            "description": "The nymber of entries returned par page",
            "schema": {
              "example": "10",
              "type": "number"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "success"
          }
        },
        "security": [
          {
            "accessToken": []
          }
        ],
        "summary": "Fetch user by id",
        "tags": [
          "Users"
        ]
      }
    },
    "/users/me/set-password": {
      "patch": {
        "operationId": "UsersController_setPassword",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SetPasswordDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "accessToken": []
          }
        ],
        "summary": "Set password for users registered via OAuth",
        "tags": [
          "Users"
        ]
      }
    },
    "/users/me/confirm-avatar-upload": {
      "post": {
        "operationId": "UsersController_confirmAvatarUpload",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ConfirmUploadDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "accessToken": []
          }
        ],
        "summary": "Confirm avatar upload and bind to user",
        "tags": [
          "Users"
        ]
      }
    },
    "/admin/users": {
      "get": {
        "operationId": "AdminUsersController_listAdmins",
        "parameters": [
          {
            "name": "search",
            "required": false,
            "in": "query",
            "description": "Search by name or email",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "role",
            "required": false,
            "in": "query",
            "schema": {
              "type": "string",
              "enum": [
                "ADMIN",
                "USER",
                "CLIENT",
                "MODERATOR"
              ]
            }
          },
          {
            "name": "isActive",
            "required": false,
            "in": "query",
            "description": "Filter by active status",
            "schema": {
              "type": "boolean"
            }
          },
          {
            "name": "page",
            "required": false,
            "in": "query",
            "schema": {
              "default": 1,
              "type": "number"
            }
          },
          {
            "name": "limit",
            "required": false,
            "in": "query",
            "schema": {
              "default": 10,
              "type": "number"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "List admin accounts",
        "tags": [
          "Admin - Users"
        ]
      },
      "post": {
        "operationId": "AdminUsersController_createAdmin",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateAdminUserDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Create admin account",
        "tags": [
          "Admin - Users"
        ]
      }
    },
    "/admin/users/{id}": {
      "patch": {
        "operationId": "AdminUsersController_updateAdmin",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateAdminUserDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Update admin account",
        "tags": [
          "Admin - Users"
        ]
      }
    },
    "/admin/users/{id}/deactivate": {
      "patch": {
        "operationId": "AdminUsersController_deactivateAdmin",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Deactivate admin account",
        "tags": [
          "Admin - Users"
        ]
      }
    },
    "/auth/signin": {
      "post": {
        "operationId": "AuthController_signIn",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SignInDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "User signed in successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SignInResponseDto"
                }
              }
            }
          }
        },
        "summary": "Sign in to an existing user account",
        "tags": [
          "Auth"
        ]
      }
    },
    "/auth/google-authentication": {
      "post": {
        "operationId": "AuthController_googleAuthentication",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "Auth"
        ]
      }
    },
    "/auth/signup": {
      "post": {
        "description": "Endpoint to create a new user account",
        "operationId": "AuthController_createNewUser",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateUserDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "User account created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "msg": {
                      "type": "string"
                    }
                  },
                  "example": {
                    "msg": "Signup successful"
                  }
                }
              }
            }
          }
        },
        "summary": "Create a new user account",
        "tags": [
          "Auth"
        ]
      }
    },
    "/auth/refresh": {
      "post": {
        "description": "Endpoint to refresh access token, send refresh token in cookie",
        "operationId": "AuthController_refresh",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Access token refreshed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "accessToken": {
                      "type": "string"
                    }
                  },
                  "example": {
                    "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ1dWlkLTEyMzQiLCJpYXQiOjE2ODgwODc2MDAsImV4cCI6MTY4ODA5MTIwMH0.XYZ"
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "refreshToken": []
          },
          {
            "refreshToken": []
          }
        ],
        "summary": "Refresh access token using refresh token",
        "tags": [
          "Auth"
        ]
      }
    },
    "/auth/signout": {
      "post": {
        "operationId": "AuthController_signOut",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "Auth"
        ]
      }
    },
    "/auth/request-password-reset": {
      "post": {
        "operationId": "AuthController_requestPasswordReset",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "email": {
                    "type": "string",
                    "format": "email"
                  }
                },
                "required": [
                  "email"
                ],
                "example": {
                  "email": "user@example.com"
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "summary": "Request password reset email",
        "tags": [
          "Auth"
        ]
      }
    },
    "/auth/reset-password": {
      "post": {
        "operationId": "AuthController_resetPassword",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/VerifyTokenResetPasswordDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "summary": "Reset user password",
        "tags": [
          "Auth"
        ]
      }
    },
    "/auth/verify-email": {
      "post": {
        "operationId": "AuthController_verifyEmail",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/VerifyTokenDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "summary": "Verify user email address",
        "tags": [
          "Auth"
        ]
      }
    },
    "/media/presigned": {
      "post": {
        "operationId": "MediaController_createPresigned",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreatePresignedDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Create a presigned upload URL",
        "tags": [
          "media"
        ]
      }
    },
    "/media/confirm": {
      "post": {
        "operationId": "MediaController_confirmUpload",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ConfirmUploadDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Confirm an uploaded object and persist media record",
        "tags": [
          "media"
        ]
      }
    },
    "/media/upload": {
      "post": {
        "operationId": "MediaController_uploadFormData",
        "parameters": [],
        "requestBody": {
          "required": true,
          "description": "Multipart upload with file and metadata",
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "file": {
                    "type": "string",
                    "format": "binary"
                  },
                  "domain": {
                    "type": "string",
                    "enum": [
                      "bus",
                      "route",
                      "trip",
                      "user",
                      "feedback"
                    ]
                  },
                  "domainId": {
                    "type": "string",
                    "format": "uuid"
                  },
                  "type": {
                    "type": "string",
                    "enum": [
                      "image",
                      "avatar",
                      "bus_photo"
                    ]
                  }
                },
                "required": [
                  "file",
                  "domain",
                  "domainId",
                  "type"
                ]
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Upload a file via multipart/form-data",
        "tags": [
          "media"
        ]
      }
    },
    "/media/{id}": {
      "delete": {
        "operationId": "MediaController_deleteMedia",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "format": "uuid",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Delete a media asset and underlying object if present",
        "tags": [
          "media"
        ]
      }
    },
    "/media": {
      "get": {
        "operationId": "MediaController_listMedia",
        "parameters": [
          {
            "name": "domain",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "domainId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "type",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "List media by owner",
        "tags": [
          "media"
        ]
      }
    },
    "/dashboard/admin": {
      "get": {
        "operationId": "DashboardController_getAdminDashboard",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Dashboard"
        ]
      }
    },
    "/dashboard/admin/analytics/revenue": {
      "get": {
        "operationId": "DashboardController_getAdminRevenueAnalytics",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Dashboard"
        ]
      }
    },
    "/dashboard/admin/analytics/bookings": {
      "get": {
        "operationId": "DashboardController_getAdminBookingAnalytics",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Dashboard"
        ]
      }
    },
    "/dashboard/user": {
      "get": {
        "operationId": "DashboardController_getUserDashboard",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Dashboard"
        ]
      }
    },
    "/admin/operators": {
      "get": {
        "operationId": "OperatorController_listOperators",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "List operators",
        "tags": [
          "Admin - Operators"
        ]
      },
      "post": {
        "operationId": "OperatorController_createOperator",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateOperatorDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Create operator",
        "tags": [
          "Admin - Operators"
        ]
      }
    },
    "/admin/operators/{id}": {
      "get": {
        "operationId": "OperatorController_getOperator",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Get operator detail",
        "tags": [
          "Admin - Operators"
        ]
      },
      "patch": {
        "operationId": "OperatorController_updateOperator",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateOperatorDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Update operator",
        "tags": [
          "Admin - Operators"
        ]
      },
      "delete": {
        "operationId": "OperatorController_deleteOperator",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "204": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Delete operator",
        "tags": [
          "Admin - Operators"
        ]
      }
    },
    "/admin/routes": {
      "get": {
        "operationId": "RouteController_listRoutes",
        "parameters": [
          {
            "name": "operatorId",
            "required": false,
            "in": "query",
            "description": "Filter by operator ID",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "isActive",
            "required": false,
            "in": "query",
            "description": "Filter by active status",
            "schema": {
              "type": "boolean"
            }
          },
          {
            "name": "page",
            "required": false,
            "in": "query",
            "description": "Page number",
            "schema": {
              "minimum": 1,
              "default": 1,
              "type": "number"
            }
          },
          {
            "name": "limit",
            "required": false,
            "in": "query",
            "description": "Items per page",
            "schema": {
              "minimum": 1,
              "default": 100,
              "type": "number"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Routes retrieved successfully"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "List routes",
        "tags": [
          "Admin - Routes"
        ]
      },
      "post": {
        "operationId": "RouteController_createRoute",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateRouteDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Route created successfully"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Create route",
        "tags": [
          "Admin - Routes"
        ]
      }
    },
    "/admin/routes/{id}": {
      "patch": {
        "operationId": "RouteController_updateRoute",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateRouteDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Route updated successfully"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Update route",
        "tags": [
          "Admin - Routes"
        ]
      },
      "delete": {
        "operationId": "RouteController_deleteRoute",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Route soft-deleted successfully"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Soft delete route",
        "tags": [
          "Admin - Routes"
        ]
      }
    },
    "/admin/routes/{routeId}/points": {
      "post": {
        "description": "Adds a pickup or dropoff point to a specific route. Points can be ordered using the orderIndex field.",
        "operationId": "RoutePointController_addRoutePoint",
        "parameters": [
          {
            "name": "routeId",
            "required": true,
            "in": "path",
            "description": "Route UUID",
            "schema": {
              "example": "550e8400-e29b-41d4-a716-446655440000",
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateRoutePointDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Route point created successfully"
          },
          "400": {
            "description": "Invalid input data"
          },
          "404": {
            "description": "Route not found"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Add a route point",
        "tags": [
          "Admin - Route Points"
        ]
      },
      "get": {
        "operationId": "RoutePointController_listRoutePoints",
        "parameters": [
          {
            "name": "routeId",
            "required": true,
            "in": "path",
            "description": "Route UUID",
            "schema": {
              "example": "550e8400-e29b-41d4-a716-446655440000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Route points retrieved successfully"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "List route points for a route",
        "tags": [
          "Admin - Route Points"
        ]
      }
    },
    "/admin/route-points/{id}": {
      "patch": {
        "description": "Updates information for a specific route point including name, address, coordinates, type, or order index.",
        "operationId": "RoutePointController_updateRoutePoint",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "Route Point UUID",
            "schema": {
              "example": "550e8400-e29b-41d4-a716-446655440000",
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateRoutePointDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Route point updated successfully"
          },
          "400": {
            "description": "Invalid input data"
          },
          "404": {
            "description": "Route point not found"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Update a route point",
        "tags": [
          "Admin - Route Points"
        ]
      },
      "delete": {
        "description": "Permanently deletes a route point. This action cannot be undone.",
        "operationId": "RoutePointController_deleteRoutePoint",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "Route Point UUID",
            "schema": {
              "example": "550e8400-e29b-41d4-a716-446655440000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Route point deleted successfully"
          },
          "404": {
            "description": "Route point not found"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Delete a route point",
        "tags": [
          "Admin - Route Points"
        ]
      }
    },
    "/admin/buses": {
      "get": {
        "operationId": "BusController_listBuses",
        "parameters": [
          {
            "name": "isActive",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Buses retrieved successfully"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "List buses",
        "tags": [
          "Admin - Buses"
        ]
      },
      "post": {
        "operationId": "BusController_createBus",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateBusDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Create bus",
        "tags": [
          "Admin - Buses"
        ]
      }
    },
    "/admin/buses/{id}": {
      "patch": {
        "operationId": "BusController_updateBus",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateBusDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Update bus",
        "tags": [
          "Admin - Buses"
        ]
      },
      "delete": {
        "operationId": "BusController_deleteBus",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "204": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Soft delete bus",
        "tags": [
          "Admin - Buses"
        ]
      }
    },
    "/admin/buses/{id}/seats": {
      "get": {
        "description": "Retrieve all seats for a specific bus. Accessible by admins and moderators.",
        "operationId": "SeatController_getSeatsByBus",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "Bus ID",
            "schema": {
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List of seats retrieved successfully"
          },
          "404": {
            "description": "Bus not found or inactive"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Get all seats for a bus",
        "tags": [
          "Admin - Seats"
        ]
      },
      "post": {
        "description": "Create a new seat for a specific bus. Accessible only by admins.",
        "operationId": "SeatController_createSeat",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "Bus ID",
            "schema": {
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateSeatDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Seat created successfully"
          },
          "404": {
            "description": "Bus not found or inactive"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Create a new seat for a bus",
        "tags": [
          "Admin - Seats"
        ]
      }
    },
    "/admin/buses/{id}/seats/generate": {
      "post": {
        "operationId": "SeatController_generateSeats",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "Bus ID",
            "schema": {
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/GenerateSeatsDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Generate seats for a bus",
        "tags": [
          "Admin - Seats"
        ]
      }
    },
    "/admin/buses/{busId}/seats/{id}": {
      "patch": {
        "description": "Update details of a specific seat. Accessible only by admins.",
        "operationId": "SeatController_updateSeat",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateSeatDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Seat updated successfully"
          },
          "404": {
            "description": "Seat not found or inactive"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Update seat information",
        "tags": [
          "Admin - Seats"
        ]
      }
    },
    "/admin/seats/{id}": {
      "delete": {
        "description": "Mark a seat as inactive for a specific bus.",
        "operationId": "SeatController_deleteSeat",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "Seat ID",
            "schema": {
              "example": "123e4567-e89b-12d3-a456-426614174000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Seat deleted (soft) successfully"
          },
          "404": {
            "description": "Seat not found or already inactive"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Delete seat (soft delete)",
        "tags": [
          "Admin - Seats"
        ]
      }
    },
    "/trips/search": {
      "get": {
        "description": "Public endpoint to search for available trips based on origin, destination, date, and number of passengers. Returns trips with available seats.",
        "operationId": "TripController_searchTrips",
        "parameters": [
          {
            "name": "from",
            "required": false,
            "in": "query",
            "description": "Origin city/location",
            "schema": {
              "example": "TP.HCM",
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": false,
            "in": "query",
            "description": "Destination city/location",
            "schema": {
              "example": "Đà Lạt",
              "type": "string"
            }
          },
          {
            "name": "date",
            "required": false,
            "in": "query",
            "description": "Departure date (YYYY-MM-DD)",
            "schema": {
              "example": "2025-12-05",
              "type": "string"
            }
          },
          {
            "name": "passengers",
            "required": false,
            "in": "query",
            "description": "Number of passengers (minimum available seats)",
            "schema": {
              "minimum": 1,
              "example": 1,
              "type": "number"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Trips found successfully",
            "content": {
              "application/json": {
                "schema": {
                  "example": [
                    {
                      "id": "uuid",
                      "from": "TP.HCM",
                      "to": "Đà Lạt",
                      "departureTime": "2025-12-05T08:00:00Z",
                      "arrivalTime": "2025-12-05T14:30:00Z",
                      "duration": "6h 30m",
                      "price": 250000,
                      "busType": "Sleeper",
                      "company": "Phương Trang",
                      "amenities": [
                        "wifi",
                        "air_conditioning",
                        "water"
                      ],
                      "seatsAvailable": 15,
                      "busModel": "Thaco Universe",
                      "plateNumber": "51A-111.11"
                    }
                  ]
                }
              }
            }
          }
        },
        "summary": "Search available trips (Public)",
        "tags": [
          "Trips"
        ]
      }
    },
    "/trips/admin": {
      "get": {
        "description": "Admin endpoint: Retrieves a paginated list of trips with optional filters for route, bus, and status.",
        "operationId": "TripController_getTripsAdmin",
        "parameters": [
          {
            "name": "routeId",
            "required": false,
            "in": "query",
            "description": "Filter by route ID",
            "schema": {
              "example": "550e8400-e29b-41d4-a716-446655440000",
              "type": "string"
            }
          },
          {
            "name": "busId",
            "required": false,
            "in": "query",
            "description": "Filter by bus ID",
            "schema": {
              "example": "550e8400-e29b-41d4-a716-446655440001",
              "type": "string"
            }
          },
          {
            "name": "status",
            "required": false,
            "in": "query",
            "description": "Filter by trip status",
            "schema": {
              "example": "scheduled",
              "type": "string",
              "enum": [
                "scheduled",
                "in_progress",
                "cancelled",
                "completed",
                "archived"
              ]
            }
          },
          {
            "name": "page",
            "required": false,
            "in": "query",
            "description": "Page number",
            "schema": {
              "minimum": 1,
              "default": 1,
              "example": 1,
              "type": "number"
            }
          },
          {
            "name": "limit",
            "required": false,
            "in": "query",
            "description": "Number of items per page",
            "schema": {
              "minimum": 1,
              "maximum": 100,
              "default": 10,
              "example": 10,
              "type": "number"
            }
          },
          {
            "name": "sortBy",
            "required": false,
            "in": "query",
            "description": "Sort by field",
            "schema": {
              "example": "departureTime",
              "type": "string",
              "enum": [
                "departureTime",
                "arrivalTime",
                "basePrice",
                "bookings"
              ]
            }
          },
          {
            "name": "sortOrder",
            "required": false,
            "in": "query",
            "description": "Sort order",
            "schema": {
              "example": "desc",
              "type": "string",
              "enum": [
                "asc",
                "desc"
              ]
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Trips retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "example": {
                    "data": [],
                    "total": 0,
                    "page": 1,
                    "limit": 10,
                    "totalPages": 0
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Get list of trips (Admin)",
        "tags": [
          "Trips"
        ]
      },
      "post": {
        "description": "Creates a new trip with route, bus, time schedule, and base price. Automatically generates seat statuses for all seats in the bus.",
        "operationId": "TripController_createTrip",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateTripDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Trip created successfully"
          },
          "400": {
            "description": "Invalid input data"
          },
          "404": {
            "description": "Route or Bus not found"
          },
          "409": {
            "description": "Bus scheduling conflict or inactive route/bus"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Create a new trip",
        "tags": [
          "Trips"
        ]
      }
    },
    "/trips/admin/{id}": {
      "get": {
        "description": "Retrieves detailed information about a specific trip including route, bus, and seat statuses.",
        "operationId": "TripController_getTripById",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "Trip UUID",
            "schema": {
              "example": "550e8400-e29b-41d4-a716-446655440000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Trip details retrieved successfully"
          },
          "404": {
            "description": "Trip not found"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Get trip details",
        "tags": [
          "Trips"
        ]
      },
      "patch": {
        "description": "Updates trip details such as route, bus, schedule, price, or status. Validates bus scheduling conflicts if time or bus is changed.",
        "operationId": "TripController_updateTrip",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "Trip UUID",
            "schema": {
              "example": "550e8400-e29b-41d4-a716-446655440000",
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateTripDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Trip updated successfully"
          },
          "404": {
            "description": "Trip not found"
          },
          "409": {
            "description": "Bus scheduling conflict"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Update trip information",
        "tags": [
          "Trips"
        ]
      }
    },
    "/trips/admin/{id}/cancel": {
      "patch": {
        "description": "Cancels a scheduled trip. Cannot cancel trips that are already completed or cancelled.",
        "operationId": "TripController_cancelTrip",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "Trip UUID",
            "schema": {
              "example": "550e8400-e29b-41d4-a716-446655440000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Trip cancelled successfully"
          },
          "404": {
            "description": "Trip not found or already cancelled/completed"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Cancel a trip",
        "tags": [
          "Trips"
        ]
      }
    },
    "/trips/{id}": {
      "get": {
        "description": "Public endpoint to retrieve detailed information about a specific trip including route, bus, operator, amenities, and available seats.",
        "operationId": "TripController_getTripDetails",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "Trip UUID",
            "schema": {
              "example": "550e8400-e29b-41d4-a716-446655440000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Trip details retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "example": {
                    "id": "uuid",
                    "from": "TP.HCM",
                    "to": "Đà Lạt",
                    "departureTime": "2025-12-05T08:00:00Z",
                    "arrivalTime": "2025-12-05T14:30:00Z",
                    "duration": "6h 30m",
                    "price": 250000,
                    "busType": "Sleeper",
                    "company": "Phương Trang",
                    "amenities": [
                      "wifi",
                      "air_conditioning",
                      "water"
                    ],
                    "seatsAvailable": 15,
                    "busModel": "Thaco Universe",
                    "plateNumber": "51A-111.11",
                    "distanceKm": 308,
                    "routePoints": {
                      "pickup": [],
                      "dropoff": []
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Trip not found"
          }
        },
        "summary": "Get trip details by ID (Public)",
        "tags": [
          "Trips"
        ]
      }
    },
    "/trips/{id}/related": {
      "get": {
        "description": "Public endpoint to retrieve related trips for a specific trip based on same route, similar dates (±3 days), and similar price range (±30%). Results are cached in Redis for 5 minutes.",
        "operationId": "TripController_getRelatedTrips",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "Trip UUID",
            "schema": {
              "example": "550e8400-e29b-41d4-a716-446655440000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Related trips retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "example": [
                    {
                      "id": "uuid",
                      "from": "TP.HCM",
                      "to": "Đà Lạt",
                      "departureTime": "2025-12-06T08:00:00Z",
                      "arrivalTime": "2025-12-06T14:30:00Z",
                      "duration": "6h 30m",
                      "price": 260000,
                      "busType": "Sleeper",
                      "company": "Phương Trang",
                      "amenities": [
                        "wifi",
                        "air_conditioning"
                      ],
                      "seatsAvailable": 20,
                      "busModel": "Thaco Universe",
                      "plateNumber": "51A-222.22"
                    }
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Trip not found"
          }
        },
        "summary": "Get related trips (Public)",
        "tags": [
          "Trips"
        ]
      }
    },
    "/seat-status/trip/{tripId}": {
      "get": {
        "description": "Retrieve seat availability and status for a specific trip",
        "operationId": "SeatStatusController_getSeatsByTrip",
        "parameters": [
          {
            "name": "tripId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Seat statuses retrieved successfully"
          },
          "404": {
            "description": "Trip not found"
          }
        },
        "summary": "Get all seat statuses for a trip",
        "tags": [
          "Seat Status"
        ]
      }
    },
    "/seat-status/lock": {
      "post": {
        "description": "Lock seats for a specific trip to prevent double booking. Seats are locked for a configured duration (default 10 minutes). Returns a lock token that must be used for subsequent booking operations. If any seat cannot be locked, the entire operation fails with no partial locks.",
        "operationId": "SeatStatusController_lockSeats",
        "parameters": [],
        "requestBody": {
          "required": true,
          "description": "Trip ID and array of seat IDs to lock",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/LockSeatsDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Seats locked successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LockSeatsSuccessResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "Invalid seat IDs or validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LockSeatsErrorResponseDto"
                }
              }
            }
          },
          "404": {
            "description": "Trip not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LockSeatsErrorResponseDto"
                }
              }
            }
          },
          "409": {
            "description": "Trip unavailable, seat locked by others, or seat already booked",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LockSeatsErrorResponseDto"
                }
              }
            }
          }
        },
        "summary": "Lock seats for booking",
        "tags": [
          "Seat Status"
        ]
      }
    },
    "/booking": {
      "post": {
        "description": "Create a booking using a valid lock token. The lock token must be obtained from the seat lock endpoint first. Validates seat availability, passenger data, and creates booking atomically. All seats will be marked as booked and lock will be released.",
        "operationId": "BookingController_createBooking",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateBookingDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Booking created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CreateBookingSuccessResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "Invalid token, validation error, or seat code mismatch",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CreateBookingErrorResponseDto"
                }
              }
            }
          },
          "404": {
            "description": "Trip not found or seats not found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CreateBookingErrorResponseDto"
                }
              }
            }
          },
          "409": {
            "description": "Seat locked by another user, already booked, or lock expired",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CreateBookingErrorResponseDto"
                }
              }
            }
          }
        },
        "summary": "Create a new booking",
        "tags": [
          "Booking"
        ]
      },
      "get": {
        "operationId": "BookingController_listBookings",
        "parameters": [
          {
            "name": "page",
            "required": false,
            "in": "query",
            "description": "Page number (1-based)",
            "schema": {
              "default": 1,
              "example": 1,
              "type": "number"
            }
          },
          {
            "name": "limit",
            "required": false,
            "in": "query",
            "description": "Items per page",
            "schema": {
              "default": 10,
              "example": 10,
              "type": "number"
            }
          },
          {
            "name": "userId",
            "required": false,
            "in": "query",
            "description": "Filter by user id",
            "schema": {
              "example": "550e8400-e29b-41d4-a716-446655440000",
              "type": "string"
            }
          },
          {
            "name": "email",
            "required": false,
            "in": "query",
            "description": "Filter by user email",
            "schema": {
              "example": "user@example.com",
              "type": "string"
            }
          },
          {
            "name": "phone",
            "required": false,
            "in": "query",
            "description": "Filter by user phone",
            "schema": {
              "example": "0909123456",
              "type": "string"
            }
          },
          {
            "name": "status",
            "required": false,
            "in": "query",
            "description": "Filter by booking status",
            "schema": {
              "example": "paid",
              "type": "string"
            }
          },
          {
            "name": "from",
            "required": false,
            "in": "query",
            "description": "From date (YYYY-MM-DD)",
            "schema": {
              "example": "2025-01-01",
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": false,
            "in": "query",
            "description": "To date (YYYY-MM-DD)",
            "schema": {
              "example": "2025-01-31",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "List bookings",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BookingListResponseDto"
                }
              }
            }
          }
        },
        "summary": "Get list of bookings (filterable)",
        "tags": [
          "Booking"
        ]
      }
    },
    "/booking/{id}": {
      "get": {
        "operationId": "BookingController_getBookingDetail",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "Booking ID",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Booking details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BookingListItemDto"
                }
              }
            }
          }
        },
        "summary": "Get booking details by ID",
        "tags": [
          "Booking"
        ]
      },
      "patch": {
        "operationId": "BookingController_updateBooking",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "Booking ID",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateBookingDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Booking updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BookingListItemDto"
                }
              }
            }
          }
        },
        "summary": "Update booking contact or passenger info",
        "tags": [
          "Booking"
        ]
      }
    },
    "/booking/{id}/seats": {
      "patch": {
        "operationId": "BookingController_changeSeats",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "Booking ID",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateSeatsDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Seats updated",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BookingListItemDto"
                }
              }
            }
          }
        },
        "summary": "Change seats for a booking",
        "tags": [
          "Booking"
        ]
      }
    },
    "/booking/{id}/cancel": {
      "patch": {
        "operationId": "BookingController_cancelBooking",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "Booking ID",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Booking cancelled",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BookingListItemDto"
                }
              }
            }
          }
        },
        "summary": "Cancel a pending booking (soft delete)",
        "tags": [
          "Booking"
        ]
      }
    },
    "/booking/{id}/status": {
      "patch": {
        "operationId": "BookingController_updateBookingStatus",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateBookingStatusDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": ""
          }
        },
        "summary": "Update booking status (Admin only)",
        "tags": [
          "Booking"
        ]
      }
    },
    "/admin/trips/{tripId}/passengers": {
      "get": {
        "operationId": "PassengerDetailController_listPassengers",
        "parameters": [
          {
            "name": "tripId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "summary": "List passengers by trip",
        "tags": [
          "Admin - Passengers"
        ]
      }
    },
    "/admin/trips/{tripId}/passengers/{passengerId}/check-in": {
      "patch": {
        "operationId": "PassengerDetailController_checkInPassenger",
        "parameters": [
          {
            "name": "tripId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "passengerId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "summary": "Check-in passenger",
        "tags": [
          "Admin - Passengers"
        ]
      }
    },
    "/admin/trips/{tripId}/passengers/{passengerId}/check-in/reset": {
      "patch": {
        "operationId": "PassengerDetailController_resetCheckIn",
        "parameters": [
          {
            "name": "tripId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "passengerId",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "summary": "Reset passenger check-in",
        "tags": [
          "Admin - Passengers"
        ]
      }
    },
    "/payment": {
      "post": {
        "operationId": "PaymentController_createPayment",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreatePaymentSession"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "Payment"
        ]
      }
    },
    "/payment/webhook": {
      "post": {
        "operationId": "PaymentController_handleWebhook",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Payment"
        ]
      }
    },
    "/payment/webhook/confirm": {
      "post": {
        "operationId": "PaymentController_confirmWebhook",
        "parameters": [],
        "responses": {
          "201": {
            "description": ""
          }
        },
        "tags": [
          "Payment"
        ]
      }
    },
    "/notification/preferences/me": {
      "get": {
        "operationId": "NotificationController_getMyPreferences",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NotificationPreferencesResponseDto"
                }
              }
            }
          }
        },
        "summary": "Get current user notification preferences",
        "tags": [
          "Notification"
        ]
      }
    },
    "/notification/preferences": {
      "patch": {
        "operationId": "NotificationController_updateMyPreferences",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateNotificationPreferencesDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NotificationPreferencesResponseDto"
                }
              }
            }
          }
        },
        "summary": "Update current user notification preferences",
        "tags": [
          "Notification"
        ]
      }
    },
    "/notification": {
      "get": {
        "operationId": "NotificationController_getMyNotifications",
        "parameters": [
          {
            "name": "status",
            "required": false,
            "in": "query",
            "description": "Filter by notification status",
            "schema": {
              "type": "string",
              "enum": [
                "pending",
                "sent",
                "failed",
                "read"
              ]
            }
          },
          {
            "name": "page",
            "required": false,
            "in": "query",
            "description": "Page number",
            "schema": {
              "minimum": 1,
              "default": 1,
              "type": "number"
            }
          },
          {
            "name": "limit",
            "required": false,
            "in": "query",
            "description": "Number of items per page",
            "schema": {
              "minimum": 1,
              "maximum": 100,
              "default": 20,
              "type": "number"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/NotificationListResponseDto"
                }
              }
            }
          }
        },
        "summary": "Get current user notifications with pagination",
        "tags": [
          "Notification"
        ]
      }
    },
    "/notification/mark-as-read": {
      "post": {
        "operationId": "NotificationController_markAsRead",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MarkAsReadDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "affected": {
                      "type": "number"
                    },
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "summary": "Mark notifications as read",
        "tags": [
          "Notification"
        ]
      }
    },
    "/notification/mark-all-as-read": {
      "post": {
        "operationId": "NotificationController_markAllAsRead",
        "parameters": [],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "affected": {
                      "type": "number"
                    },
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "summary": "Mark all notifications as read",
        "tags": [
          "Notification"
        ]
      }
    },
    "/notification/{id}": {
      "delete": {
        "operationId": "NotificationController_deleteNotification",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "summary": "Delete a single notification",
        "tags": [
          "Notification"
        ]
      }
    },
    "/notification/delete-multiple": {
      "post": {
        "operationId": "NotificationController_deleteMultipleNotifications",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MarkAsReadDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "affected": {
                      "type": "number"
                    },
                    "message": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "summary": "Delete multiple notifications",
        "tags": [
          "Notification"
        ]
      }
    },
    "/feedback": {
      "post": {
        "operationId": "FeedbackController_createFeedback",
        "parameters": [],
        "requestBody": {
          "required": true,
          "description": "Feedback data with optional photos",
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "bookingId": {
                    "type": "string",
                    "format": "uuid",
                    "description": "Booking ID"
                  },
                  "rating": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 5,
                    "description": "Trip rating (1-5)"
                  },
                  "recommendation": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 10,
                    "description": "Recommendation score (1-10)"
                  },
                  "comment": {
                    "type": "string",
                    "minLength": 10,
                    "maxLength": 1000,
                    "description": "Feedback comment"
                  },
                  "photos": {
                    "type": "array",
                    "items": {
                      "type": "string",
                      "format": "binary"
                    },
                    "maxItems": 5,
                    "description": "Photos (max 5, only JPEG/PNG/WebP/SVG)"
                  }
                },
                "required": [
                  "bookingId",
                  "rating",
                  "recommendation",
                  "comment"
                ]
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Submit feedback for a completed trip",
        "tags": [
          "feedback"
        ]
      }
    },
    "/feedback/booking/{bookingId}": {
      "get": {
        "operationId": "FeedbackController_getFeedbackByBooking",
        "parameters": [
          {
            "name": "bookingId",
            "required": true,
            "in": "path",
            "schema": {
              "format": "uuid",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "summary": "Get feedback by booking ID",
        "tags": [
          "feedback"
        ]
      }
    },
    "/feedback/trip/{tripId}": {
      "get": {
        "operationId": "FeedbackController_getFeedbackByTrip",
        "parameters": [
          {
            "name": "tripId",
            "required": true,
            "in": "path",
            "schema": {
              "format": "uuid",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "summary": "Get all feedback for a trip",
        "tags": [
          "feedback"
        ]
      }
    },
    "/feedback/user/{userId}": {
      "get": {
        "operationId": "FeedbackController_getFeedbackByUser",
        "parameters": [
          {
            "name": "userId",
            "required": true,
            "in": "path",
            "schema": {
              "format": "uuid",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Get all feedback by user",
        "tags": [
          "feedback"
        ]
      }
    },
    "/reports/admin": {
      "get": {
        "operationId": "ReportController_getAdminReport",
        "parameters": [
          {
            "name": "from",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "operatorId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "routeId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "groupBy",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Report"
        ]
      }
    },
    "/reports/admin/export": {
      "get": {
        "operationId": "ReportController_exportAdminReport",
        "parameters": [
          {
            "name": "from",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "to",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "operatorId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "routeId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "groupBy",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Report"
        ]
      }
    },
    "/schedule/health": {
      "get": {
        "operationId": "ScheduleController_getHealth",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Schedule"
        ]
      }
    },
    "/metrics": {
      "get": {
        "operationId": "MetricsController_getMetrics",
        "parameters": [],
        "responses": {
          "200": {
            "description": ""
          }
        },
        "tags": [
          "Metrics"
        ]
      }
    }
  },
  "info": {
    "title": "Nest Auth API Documentation",
    "description": "The description of my application",
    "version": "1.0",
    "contact": {}
  },
  "tags": [],
  "servers": [
    {
      "url": "http://localhost:3000/api"
    }
  ],
  "components": {
    "securitySchemes": {
      "cookie": {
        "type": "apiKey",
        "in": "cookie",
        "name": "refreshToken"
      },
      "accessToken": {
        "type": "http",
        "scheme": "bearer"
      }
    },
    "schemas": {
      "UpdateProfileDto": {
        "type": "object",
        "properties": {
          "firstName": {
            "type": "string",
            "title": "First Name",
            "example": "Admin"
          },
          "lastName": {
            "type": "string",
            "title": "Last Name",
            "example": "User"
          },
          "email": {
            "type": "string",
            "title": "Email",
            "example": "admin@example.com"
          },
          "username": {
            "type": "string",
            "title": "Username",
            "example": "admin_user"
          }
        }
      },
      "ChangePasswordDto": {
        "type": "object",
        "properties": {
          "currentPassword": {
            "type": "string",
            "title": "Current Password",
            "example": "currentPass123"
          },
          "newPassword": {
            "type": "string",
            "title": "New Password",
            "example": "newPass123"
          }
        },
        "required": [
          "currentPassword",
          "newPassword"
        ]
      },
      "SetPasswordDto": {
        "type": "object",
        "properties": {
          "newPassword": {
            "type": "string",
            "title": "New Password",
            "example": "newPass123"
          }
        },
        "required": [
          "newPassword"
        ]
      },
      "ConfirmUploadDto": {
        "type": "object",
        "properties": {
          "key": {
            "type": "string",
            "description": "Object storage key used during presign"
          },
          "domain": {
            "type": "string",
            "enum": [
              "bus",
              "route",
              "trip",
              "user",
              "feedback"
            ]
          },
          "domainId": {
            "type": "string",
            "format": "uuid"
          },
          "type": {
            "type": "string",
            "enum": [
              "image",
              "avatar",
              "bus_photo"
            ]
          }
        },
        "required": [
          "key",
          "domain",
          "domainId",
          "type"
        ]
      },
      "CreateAdminUserDto": {
        "type": "object",
        "properties": {
          "firstName": {
            "type": "string",
            "title": "First Name",
            "example": "Admin"
          },
          "lastName": {
            "type": "string",
            "title": "Last Name",
            "example": "User"
          },
          "email": {
            "type": "string",
            "title": "Email",
            "example": "admin@example.com"
          },
          "password": {
            "type": "string",
            "title": "Password",
            "example": "strongPassword123"
          },
          "role": {
            "type": "string",
            "title": "Role",
            "example": "ADMIN",
            "enum": [
              "ADMIN",
              "USER",
              "CLIENT",
              "MODERATOR"
            ]
          },
          "isActive": {
            "type": "boolean",
            "title": "Active",
            "example": true
          }
        },
        "required": [
          "firstName",
          "email",
          "password"
        ]
      },
      "UpdateAdminUserDto": {
        "type": "object",
        "properties": {
          "firstName": {
            "type": "string",
            "title": "First Name",
            "example": "Admin"
          },
          "lastName": {
            "type": "string",
            "title": "Last Name",
            "example": "User"
          },
          "email": {
            "type": "string",
            "title": "Email",
            "example": "admin@example.com"
          },
          "password": {
            "type": "string",
            "title": "Password",
            "example": "newPassword123"
          },
          "role": {
            "type": "string",
            "title": "Role",
            "example": "ADMIN",
            "enum": [
              "ADMIN",
              "USER",
              "CLIENT",
              "MODERATOR"
            ]
          },
          "isActive": {
            "type": "boolean",
            "title": "Active",
            "example": true
          }
        }
      },
      "SignInDto": {
        "type": "object",
        "properties": {
          "emailOrUsername": {
            "type": "string",
            "example": "user@example.com",
            "description": "The email address or username of the user"
          },
          "password": {
            "type": "string",
            "example": "strongPassword123",
            "description": "The password of the user"
          }
        },
        "required": [
          "emailOrUsername",
          "password"
        ]
      },
      "SignInResponseDto": {
        "type": "object",
        "properties": {}
      },
      "CreateUserDto": {
        "type": "object",
        "properties": {
          "firstName": {
            "type": "string",
            "title": "First Name",
            "example": "John"
          },
          "lastName": {
            "type": "string",
            "title": "Last Name",
            "example": "Doe"
          },
          "username": {
            "type": "string",
            "title": "Username",
            "example": "johndoe"
          },
          "email": {
            "type": "string",
            "title": "Email",
            "example": "johndoe@example.com"
          },
          "password": {
            "type": "string",
            "title": "Password",
            "example": "strongPassword123"
          }
        },
        "required": [
          "firstName",
          "lastName",
          "username",
          "email",
          "password"
        ]
      },
      "VerifyTokenResetPasswordDto": {
        "type": "object",
        "properties": {
          "email": {
            "type": "string",
            "example": "user@example.com",
            "description": "The email address associated with the user account"
          },
          "token": {
            "type": "string",
            "example": "verification-token-12345",
            "description": "The verification token to be verified"
          },
          "password": {
            "type": "string",
            "example": "newPassword123",
            "description": "The new password for resetting the user account"
          }
        },
        "required": [
          "email",
          "token",
          "password"
        ]
      },
      "VerifyTokenDto": {
        "type": "object",
        "properties": {
          "email": {
            "type": "string",
            "example": "user@example.com",
            "description": "The email address associated with the user account"
          },
          "token": {
            "type": "string",
            "example": "verification-token-12345",
            "description": "The verification token to be verified"
          }
        },
        "required": [
          "email",
          "token"
        ]
      },
      "CreatePresignedDto": {
        "type": "object",
        "properties": {
          "domain": {
            "type": "string",
            "enum": [
              "bus",
              "route",
              "trip",
              "user",
              "feedback"
            ]
          },
          "domainId": {
            "type": "string",
            "format": "uuid"
          },
          "type": {
            "type": "string",
            "enum": [
              "image",
              "avatar",
              "bus_photo"
            ]
          },
          "extension": {
            "type": "string",
            "description": "File extension without dot, e.g. jpg"
          }
        },
        "required": [
          "domain",
          "domainId",
          "type"
        ]
      },
      "CreateOperatorDto": {
        "type": "object",
        "properties": {}
      },
      "UpdateOperatorDto": {
        "type": "object",
        "properties": {}
      },
      "CreateRouteDto": {
        "type": "object",
        "properties": {
          "operatorId": {
            "type": "string",
            "description": "Operator ID"
          },
          "origin": {
            "type": "string",
            "description": "Origin city"
          },
          "destination": {
            "type": "string",
            "description": "Destination city"
          },
          "distanceKm": {
            "type": "number",
            "description": "Distance in kilometers"
          },
          "estimatedMinutes": {
            "type": "number",
            "description": "Estimated duration in minutes"
          },
          "notes": {
            "type": "string",
            "description": "Notes"
          }
        },
        "required": [
          "origin",
          "destination",
          "distanceKm",
          "estimatedMinutes"
        ]
      },
      "UpdateRouteDto": {
        "type": "object",
        "properties": {
          "isActive": {
            "type": "boolean",
            "description": "Active status"
          },
          "operatorId": {
            "type": "string",
            "description": "Operator ID"
          },
          "origin": {
            "type": "string",
            "description": "Origin city"
          },
          "destination": {
            "type": "string",
            "description": "Destination city"
          },
          "distanceKm": {
            "type": "number",
            "description": "Distance in kilometers"
          },
          "estimatedMinutes": {
            "type": "number",
            "description": "Estimated duration in minutes"
          },
          "notes": {
            "type": "string",
            "description": "Notes"
          }
        }
      },
      "CreateRoutePointDto": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "description": "Type of route point",
            "enum": [
              "pickup",
              "dropoff"
            ],
            "example": "pickup"
          },
          "name": {
            "type": "string",
            "description": "Name of the route point",
            "example": "Bến xe Miền Đông"
          },
          "address": {
            "type": "string",
            "description": "Full address of the route point",
            "example": "292 Đinh Bộ Lĩnh, Phường 26, Bình Thạnh, TP.HCM"
          },
          "latitude": {
            "type": "number",
            "description": "Latitude coordinate",
            "example": 10.8142
          },
          "longitude": {
            "type": "number",
            "description": "Longitude coordinate",
            "example": 106.7053
          },
          "orderIndex": {
            "type": "number",
            "description": "Order index for sorting points",
            "example": 1,
            "minimum": 0,
            "default": 0
          }
        },
        "required": [
          "type",
          "name",
          "address",
          "orderIndex"
        ]
      },
      "UpdateRoutePointDto": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "description": "Type of route point",
            "enum": [
              "pickup",
              "dropoff"
            ],
            "example": "pickup"
          },
          "name": {
            "type": "string",
            "description": "Name of the route point",
            "example": "Bến xe Miền Đông"
          },
          "address": {
            "type": "string",
            "description": "Full address of the route point",
            "example": "292 Đinh Bộ Lĩnh, Phường 26, Bình Thạnh, TP.HCM"
          },
          "latitude": {
            "type": "number",
            "description": "Latitude coordinate",
            "example": 10.8142
          },
          "longitude": {
            "type": "number",
            "description": "Longitude coordinate",
            "example": 106.7053
          },
          "orderIndex": {
            "type": "number",
            "description": "Order index for sorting points",
            "example": 1,
            "minimum": 0,
            "default": 0
          }
        }
      },
      "CreateBusDto": {
        "type": "object",
        "properties": {
          "operatorId": {
            "type": "string",
            "example": "operator-uuid"
          },
          "plateNumber": {
            "type": "string",
            "example": "51F-12345"
          },
          "model": {
            "type": "string",
            "example": "Hyundai Universe"
          },
          "busType": {
            "type": "string",
            "example": "Sleeper"
          },
          "seatCapacity": {
            "type": "number",
            "example": 40
          },
          "amenitiesJson": {
            "type": "string",
            "example": "{\"wifi\":true,\"water\":true}"
          },
          "name": {
            "type": "string",
            "example": "VIP Sleeper 40"
          }
        },
        "required": [
          "operatorId",
          "plateNumber",
          "model",
          "seatCapacity"
        ]
      },
      "UpdateBusDto": {
        "type": "object",
        "properties": {
          "operatorId": {
            "type": "string",
            "example": "operator-uuid"
          },
          "plateNumber": {
            "type": "string",
            "example": "51F-12345"
          },
          "model": {
            "type": "string",
            "example": "Hyundai Universe"
          },
          "busType": {
            "type": "string",
            "example": "Sleeper"
          },
          "seatCapacity": {
            "type": "number",
            "example": 40
          },
          "amenitiesJson": {
            "type": "string",
            "example": "{\"wifi\":true,\"water\":true}"
          },
          "name": {
            "type": "string",
            "example": "VIP Sleeper 40"
          },
          "isActive": {
            "type": "boolean",
            "description": "Active status"
          }
        }
      },
      "CreateSeatDto": {
        "type": "object",
        "properties": {
          "seatCode": {
            "type": "string",
            "description": "Seat code (e.g., A1, A2, B1, B2)",
            "example": "A1"
          },
          "seatType": {
            "type": "string",
            "description": "Seat type",
            "enum": [
              "STANDARD",
              "PREMIUM",
              "VIP"
            ],
            "example": "STANDARD"
          }
        },
        "required": [
          "seatCode",
          "seatType"
        ]
      },
      "GenerateSeatsDto": {
        "type": "object",
        "properties": {
          "capacity": {
            "type": "number",
            "description": "Total seats to generate"
          },
          "columns": {
            "type": "number",
            "description": "Number of columns per row"
          },
          "seatType": {
            "type": "string",
            "enum": [
              "STANDARD",
              "PREMIUM",
              "VIP"
            ],
            "description": "Seat type"
          },
          "replaceExisting": {
            "type": "boolean",
            "description": "Replace existing seats"
          }
        }
      },
      "UpdateSeatDto": {
        "type": "object",
        "properties": {
          "seatCode": {
            "type": "string",
            "description": "Seat code (e.g., A1, A2, B1, B2)",
            "example": "A1"
          },
          "seatType": {
            "type": "string",
            "description": "Seat type",
            "enum": [
              "STANDARD",
              "PREMIUM",
              "VIP"
            ],
            "example": "STANDARD"
          },
          "isActive": {
            "type": "boolean",
            "description": "Whether the seat is active/usable",
            "example": true
          }
        }
      },
      "CreateTripDto": {
        "type": "object",
        "properties": {
          "routeId": {
            "type": "string",
            "description": "Route ID for the trip",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "busId": {
            "type": "string",
            "description": "Bus ID for the trip",
            "example": "550e8400-e29b-41d4-a716-446655440001"
          },
          "departureTime": {
            "type": "string",
            "description": "Departure date and time (ISO 8601 format)",
            "example": "2025-12-05T08:00:00Z"
          },
          "arrivalTime": {
            "type": "string",
            "description": "Arrival date and time (ISO 8601 format)",
            "example": "2025-12-05T14:30:00Z"
          },
          "basePrice": {
            "type": "number",
            "description": "Base price for the trip in VND",
            "example": 250000,
            "minimum": 0
          }
        },
        "required": [
          "routeId",
          "busId",
          "departureTime",
          "arrivalTime",
          "basePrice"
        ]
      },
      "UpdateTripDto": {
        "type": "object",
        "properties": {
          "routeId": {
            "type": "string",
            "description": "Route ID for the trip",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "busId": {
            "type": "string",
            "description": "Bus ID for the trip",
            "example": "550e8400-e29b-41d4-a716-446655440001"
          },
          "departureTime": {
            "type": "string",
            "description": "Departure date and time (ISO 8601 format)",
            "example": "2025-12-05T08:00:00Z"
          },
          "arrivalTime": {
            "type": "string",
            "description": "Arrival date and time (ISO 8601 format)",
            "example": "2025-12-05T14:30:00Z"
          },
          "basePrice": {
            "type": "number",
            "description": "Base price for the trip in VND",
            "example": 250000,
            "minimum": 0
          },
          "status": {
            "type": "string",
            "description": "Trip status",
            "enum": [
              "scheduled",
              "in_progress",
              "cancelled",
              "completed",
              "archived"
            ],
            "example": "scheduled"
          }
        }
      },
      "LockSeatsDto": {
        "type": "object",
        "properties": {
          "tripId": {
            "type": "string",
            "description": "Trip ID to lock seats for",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "seatIds": {
            "description": "Array of seat IDs to lock",
            "example": [
              "seat-id-1",
              "seat-id-2",
              "seat-id-3"
            ],
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        },
        "required": [
          "tripId",
          "seatIds"
        ]
      },
      "LockSeatsSuccessResponseDto": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Success flag",
            "example": true
          },
          "tripId": {
            "type": "string",
            "description": "Trip ID",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "seatIds": {
            "description": "Array of locked seat IDs",
            "example": [
              "seat-id-1",
              "seat-id-2"
            ],
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "lockedUntil": {
            "type": "string",
            "description": "ISO timestamp until which seats are locked",
            "example": "2025-02-20T09:30:00Z"
          },
          "lockToken": {
            "type": "string",
            "description": "JWT token to use for subsequent booking operations",
            "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
          }
        },
        "required": [
          "success",
          "tripId",
          "seatIds",
          "lockedUntil",
          "lockToken"
        ]
      },
      "LockSeatsErrorResponseDto": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Success flag",
            "example": false
          },
          "error": {
            "type": "string",
            "description": "Error code",
            "enum": [
              "TRIP_NOT_FOUND",
              "TRIP_UNAVAILABLE",
              "INVALID_SEAT",
              "SEAT_LOCKED",
              "SEAT_BOOKED",
              "SEAT_NOT_FOUND"
            ],
            "example": "SEAT_LOCKED"
          },
          "message": {
            "type": "string",
            "description": "Error message",
            "example": "Seat is already locked by another user"
          },
          "seat": {
            "type": "string",
            "description": "ID of the problematic seat (if applicable)",
            "example": "seat-id-x"
          },
          "lockedUntil": {
            "type": "string",
            "description": "Locked until timestamp (if seat is locked)",
            "example": "2025-02-20T09:25:00Z"
          }
        },
        "required": [
          "success",
          "error",
          "message"
        ]
      },
      "PassengerDto": {
        "type": "object",
        "properties": {
          "fullName": {
            "type": "string",
            "description": "Full name of the passenger",
            "example": "Nguyen Van A"
          },
          "documentId": {
            "type": "string",
            "description": "Government-issued document ID (CMND/CCCD)",
            "example": "0123456789"
          },
          "phone": {
            "type": "string",
            "description": "Phone number of the passenger (optional)",
            "example": "0909123456"
          },
          "seatCode": {
            "type": "string",
            "description": "Seat code assigned to this passenger",
            "example": "A1"
          }
        },
        "required": [
          "fullName",
          "documentId",
          "seatCode"
        ]
      },
      "ContactInfoDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Contact person name",
            "example": "Nguyen Van A"
          },
          "email": {
            "type": "string",
            "description": "Contact email address",
            "example": "nguyenvana@gmail.com"
          },
          "phone": {
            "type": "string",
            "description": "Contact phone number",
            "example": "0909123456"
          }
        },
        "required": [
          "name",
          "email",
          "phone"
        ]
      },
      "CreateBookingDto": {
        "type": "object",
        "properties": {
          "lockToken": {
            "type": "string",
            "description": "JWT lock token obtained from the seat lock endpoint, contains tripId and seatIds",
            "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
          },
          "passengers": {
            "description": "Array of passenger information. Must match the number of locked seats.",
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PassengerDto"
            }
          },
          "contactInfo": {
            "description": "Contact information for booking confirmation",
            "allOf": [
              {
                "$ref": "#/components/schemas/ContactInfoDto"
              }
            ]
          },
          "paymentMethodId": {
            "type": "string",
            "description": "UUID of the payment method to use for this booking (optional for now)",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "userId": {
            "type": "string",
            "description": "Optional user ID for authenticated users",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "pickupPointId": {
            "type": "string",
            "description": "Pickup route point ID selected by the passenger",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "dropoffPointId": {
            "type": "string",
            "description": "Dropoff route point ID selected by the passenger",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          }
        },
        "required": [
          "lockToken",
          "passengers",
          "contactInfo"
        ]
      },
      "SeatInfoDto": {
        "type": "object",
        "properties": {
          "seatId": {
            "type": "string",
            "description": "UUID of the seat",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "seatCode": {
            "type": "string",
            "description": "Seat code (e.g., A1, B2)",
            "example": "A1"
          }
        },
        "required": [
          "seatId",
          "seatCode"
        ]
      },
      "PassengerInfoDto": {
        "type": "object",
        "properties": {
          "fullName": {
            "type": "string",
            "description": "Full name of the passenger",
            "example": "Nguyen Van A"
          },
          "documentId": {
            "type": "string",
            "description": "Document ID (CMND/CCCD)",
            "example": "0123456789"
          },
          "seatCode": {
            "type": "string",
            "description": "Seat code assigned to passenger",
            "example": "A1"
          }
        },
        "required": [
          "fullName",
          "documentId",
          "seatCode"
        ]
      },
      "RoutePointSelectionDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "Route point ID",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "type": {
            "type": "string",
            "description": "Route point type",
            "example": "pickup"
          },
          "name": {
            "type": "string",
            "description": "Route point name",
            "example": "Bến xe Miền Đông"
          },
          "address": {
            "type": "string",
            "description": "Route point address",
            "example": "292 Đinh Bộ Lĩnh, Bình Thạnh, TP.HCM"
          },
          "orderIndex": {
            "type": "number",
            "description": "Order index",
            "example": 1
          }
        },
        "required": [
          "id",
          "type",
          "name",
          "address",
          "orderIndex"
        ]
      },
      "CreateBookingSuccessResponseDto": {
        "type": "object",
        "properties": {
          "bookingId": {
            "type": "string",
            "description": "UUID of the created booking",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "tripId": {
            "type": "string",
            "description": "UUID of the trip",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "userId": {
            "type": "object",
            "description": "UUID of the user who made the booking (if authenticated)",
            "example": "550e8400-e29b-41d4-a716-446655440000",
            "nullable": true
          },
          "bookingReference": {
            "type": "object",
            "description": "Booking reference code (if applicable)",
            "example": "BR123456789",
            "nullable": true
          },
          "status": {
            "type": "string",
            "description": "Booking status",
            "example": "pending",
            "enum": [
              "pending",
              "paid",
              "cancelled",
              "expired",
              "reviewed"
            ]
          },
          "seats": {
            "description": "Array of booked seats",
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SeatInfoDto"
            }
          },
          "passengers": {
            "description": "Array of passenger details",
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PassengerInfoDto"
            }
          },
          "totalAmount": {
            "type": "number",
            "description": "Total amount to be paid",
            "example": 300000
          },
          "paymentMethodId": {
            "type": "string",
            "description": "Payment method ID (if provided)",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "createdAt": {
            "type": "string",
            "description": "Timestamp when booking was created",
            "example": "2025-12-06T12:30:00.000Z"
          },
          "pickupPoint": {
            "description": "Selected pickup point (if any)",
            "nullable": true,
            "allOf": [
              {
                "$ref": "#/components/schemas/RoutePointSelectionDto"
              }
            ]
          },
          "dropoffPoint": {
            "description": "Selected dropoff point (if any)",
            "nullable": true,
            "allOf": [
              {
                "$ref": "#/components/schemas/RoutePointSelectionDto"
              }
            ]
          }
        },
        "required": [
          "bookingId",
          "tripId",
          "userId",
          "bookingReference",
          "status",
          "seats",
          "passengers",
          "totalAmount",
          "createdAt"
        ]
      },
      "CreateBookingErrorResponseDto": {
        "type": "object",
        "properties": {
          "message": {
            "type": "string",
            "description": "Error message describing what went wrong",
            "examples": [
              "Invalid or expired lock token",
              "Seat is locked or booked",
              "Number of passengers must match number of seats",
              "Passenger seatCode does not match requested seat"
            ]
          },
          "seat": {
            "type": "string",
            "description": "Additional error details (e.g., seat code that failed)",
            "example": "A1"
          },
          "code": {
            "type": "string",
            "description": "Error code for programmatic handling",
            "examples": [
              "INVALID_TOKEN",
              "TOKEN_EXPIRED",
              "SEAT_UNAVAILABLE",
              "PASSENGER_MISMATCH",
              "SEAT_CODE_MISMATCH"
            ]
          }
        },
        "required": [
          "message"
        ]
      },
      "TripBriefDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "Trip ID",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "routeId": {
            "type": "string",
            "description": "Route ID",
            "example": "route-id-123"
          },
          "origin": {
            "type": "string",
            "description": "Route origin",
            "example": "Hanoi"
          },
          "destination": {
            "type": "string",
            "description": "Route destination",
            "example": "Saigon"
          },
          "busId": {
            "type": "string",
            "description": "Bus ID",
            "example": "bus-id-123"
          },
          "departureTime": {
            "type": "string",
            "description": "Departure time",
            "example": "2025-12-06T10:00:00.000Z"
          },
          "arrivalTime": {
            "type": "string",
            "description": "Arrival time",
            "example": "2025-12-06T14:00:00.000Z"
          },
          "basePrice": {
            "type": "number",
            "description": "Trip base price",
            "example": 200000
          },
          "status": {
            "type": "string",
            "description": "Trip status",
            "example": "scheduled"
          }
        },
        "required": [
          "id",
          "routeId",
          "origin",
          "destination",
          "busId",
          "departureTime",
          "arrivalTime",
          "basePrice",
          "status"
        ]
      },
      "BookingListItemDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "Booking ID",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "tripId": {
            "type": "string",
            "description": "Trip ID",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "userId": {
            "type": "object",
            "description": "User ID (nullable)",
            "example": "550e8400-e29b-41d4-a716-446655440000",
            "nullable": true
          },
          "bookingReference": {
            "type": "object",
            "description": "Booking reference (if any)",
            "example": "BR123456789",
            "nullable": true
          },
          "status": {
            "type": "string",
            "description": "Status",
            "example": "pending",
            "enum": [
              "pending",
              "paid",
              "cancelled",
              "expired",
              "reviewed"
            ]
          },
          "totalAmount": {
            "type": "number",
            "description": "Total amount",
            "example": 300000
          },
          "createdAt": {
            "type": "string",
            "description": "Created timestamp",
            "example": "2025-12-06T12:30:00.000Z"
          },
          "name": {
            "type": "string",
            "description": "Name of the person who made the booking",
            "example": "John Doe"
          },
          "email": {
            "type": "string",
            "description": "Email of the person who made the booking",
            "example": "d@example.com"
          },
          "phone": {
            "type": "string",
            "description": "Phone number of the person who made the booking",
            "example": "+1234567890"
          },
          "trip": {
            "description": "Trip information",
            "allOf": [
              {
                "$ref": "#/components/schemas/TripBriefDto"
              }
            ]
          },
          "seats": {
            "description": "Seats in the booking",
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SeatInfoDto"
            }
          },
          "passengers": {
            "description": "Passengers in the booking",
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PassengerInfoDto"
            }
          },
          "pickupPoint": {
            "description": "Selected pickup point (if any)",
            "nullable": true,
            "allOf": [
              {
                "$ref": "#/components/schemas/RoutePointSelectionDto"
              }
            ]
          },
          "dropoffPoint": {
            "description": "Selected dropoff point (if any)",
            "nullable": true,
            "allOf": [
              {
                "$ref": "#/components/schemas/RoutePointSelectionDto"
              }
            ]
          }
        },
        "required": [
          "id",
          "tripId",
          "userId",
          "bookingReference",
          "status",
          "totalAmount",
          "createdAt",
          "name",
          "email",
          "phone",
          "trip",
          "seats",
          "passengers"
        ]
      },
      "BookingListResponseDto": {
        "type": "object",
        "properties": {
          "data": {
            "description": "List of bookings",
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/BookingListItemDto"
            }
          },
          "total": {
            "type": "number",
            "description": "Total items",
            "example": 42
          },
          "page": {
            "type": "number",
            "description": "Current page (1-based)",
            "example": 1
          },
          "limit": {
            "type": "number",
            "description": "Items per page",
            "example": 10
          }
        },
        "required": [
          "data",
          "total",
          "page",
          "limit"
        ]
      },
      "UpdatePassengerDto": {
        "type": "object",
        "properties": {
          "seatCode": {
            "type": "string",
            "description": "Seat code used as identifier for the passenger row",
            "example": "A1"
          },
          "fullName": {
            "type": "string",
            "description": "Updated full name",
            "example": "Le Van B"
          },
          "documentId": {
            "type": "string",
            "description": "Updated document ID",
            "example": "0123456789"
          }
        }
      },
      "UpdateBookingDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "Contact name",
            "example": "Nguyen Van A"
          },
          "email": {
            "type": "string",
            "description": "Contact email",
            "example": "new@example.com"
          },
          "phone": {
            "type": "string",
            "description": "Contact phone",
            "example": "0909123456"
          },
          "passengers": {
            "description": "Passenger updates keyed by seatCode; only personal info allowed",
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/UpdatePassengerDto"
            }
          }
        }
      },
      "SeatChangeDto": {
        "type": "object",
        "properties": {
          "currentSeatId": {
            "type": "string",
            "description": "Current seat ID in this booking",
            "example": "current-seat-uuid"
          },
          "newSeatId": {
            "type": "string",
            "description": "Target seat ID to switch to (must be available in this trip)",
            "example": "new-seat-uuid"
          }
        },
        "required": [
          "currentSeatId",
          "newSeatId"
        ]
      },
      "UpdateSeatsDto": {
        "type": "object",
        "properties": {
          "seatChanges": {
            "description": "List of seat changes to apply in one operation",
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SeatChangeDto"
            }
          }
        },
        "required": [
          "seatChanges"
        ]
      },
      "UpdateBookingStatusDto": {
        "type": "object",
        "properties": {
          "status": {
            "type": "string",
            "example": "paid"
          }
        },
        "required": [
          "status"
        ]
      },
      "CreatePaymentSession": {
        "type": "object",
        "properties": {}
      },
      "NotificationPreferencesResponseDto": {
        "type": "object",
        "properties": {
          "emailRemindersEnabled": {
            "type": "boolean",
            "description": "Whether email reminders are enabled"
          },
          "smsRemindersEnabled": {
            "type": "boolean",
            "description": "Whether SMS reminders are enabled"
          },
          "updatedAt": {
            "type": "string",
            "description": "When the preferences were last updated"
          }
        },
        "required": [
          "emailRemindersEnabled",
          "smsRemindersEnabled",
          "updatedAt"
        ]
      },
      "UpdateNotificationPreferencesDto": {
        "type": "object",
        "properties": {
          "emailRemindersEnabled": {
            "type": "boolean",
            "description": "Enable or disable email notifications for reminders",
            "example": true
          },
          "smsRemindersEnabled": {
            "type": "boolean",
            "description": "Enable or disable SMS notifications for reminders (requires phone)",
            "example": false
          }
        }
      },
      "NotificationResponseDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "userId": {
            "type": "string"
          },
          "channel": {
            "type": "string",
            "enum": [
              "email",
              "sms",
              "in_app"
            ]
          },
          "type": {
            "type": "string",
            "enum": [
              "trip_reminder_24h",
              "trip_reminder_3h",
              "trip_live_update",
              "booking_confirmation",
              "booking_incomplete"
            ]
          },
          "status": {
            "type": "string",
            "enum": [
              "pending",
              "sent",
              "failed",
              "read"
            ]
          },
          "payload": {
            "type": "object"
          },
          "sentAt": {
            "type": "string"
          },
          "readAt": {
            "type": "string"
          }
        },
        "required": [
          "id",
          "userId",
          "channel",
          "type",
          "status",
          "payload"
        ]
      },
      "NotificationListResponseDto": {
        "type": "object",
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/NotificationResponseDto"
            }
          },
          "total": {
            "type": "number"
          },
          "page": {
            "type": "number"
          },
          "limit": {
            "type": "number"
          },
          "totalPages": {
            "type": "number"
          },
          "unreadCount": {
            "type": "number"
          }
        },
        "required": [
          "data",
          "total",
          "page",
          "limit",
          "totalPages",
          "unreadCount"
        ]
      },
      "MarkAsReadDto": {
        "type": "object",
        "properties": {
          "notificationIds": {
            "description": "Array of notification IDs to mark as read",
            "example": [
              "uuid-1",
              "uuid-2"
            ],
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        },
        "required": [
          "notificationIds"
        ]
      }
    }
  }
}